---
title: "NFL Data Cleaning"
output: html_notebook
---

```{r}
library(tidyverse)
setwd("/Users/timmorales/Documents/GitHub/NFL_Coverage/nfl-big-data-bowl-2021")
player <- read.csv("players.csv")
plays <- read.csv("plays.csv")
df <- read.csv("downANDdist.csv")
```

# To Do List 

* Identify reciever formations (bunch, trips, etc)
* Identify press coverage 
* Identify closest reciever
* Identify the field vs the boundary or the X/Y reciever 


```{r}
df <-  df %>%
  mutate(
    rbs = substr(personnelO, str_locate(personnelO, "RB")- 3,str_locate(personnelO, "RB")-2),
    tes = substr(personnelO, str_locate(personnelO, "TE")- 3,str_locate(personnelO, "TE")-2),
    wrs = substr(personnelO, str_locate(personnelO, "WR")- 3,str_locate(personnelO, "WR")-2),
    dbs = substr(personnelO, str_locate(personnelD, "DB")- 3,str_locate(personnelD, "DB")-2),
    lbs = substr(personnelO, str_locate(personnelD, "LB")- 3,str_locate(personnelD, "LB")-2),
    dls = substr(personnelO, str_locate(personnelD, "DL")- 3,str_locate(personnelD, "DL")-2),
    converted = ifelse(yardsToGo <= playResult, 1,0),
    sob = ifelse(position %in% c("FS", "SS","CB", "MLB", "OLB", "DB", "DE", "DT", "ILB","LB", "S", "NT"),"d","o"),
    offense_home = ifelse(((sob == "o" & team == "home") | (sob == "d" & team == "away")),1, 0),
    yards_to_gl = ifelse(possessionTeam == yardlineSide, yardlineNumber, (50 + (50-yardlineNumber))))


test <- df %>%
  group_by("gameId","playId")

levels(as.factor(df$position))


```